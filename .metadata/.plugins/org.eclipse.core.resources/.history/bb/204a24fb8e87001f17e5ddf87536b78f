package com.ust.security.model;

public class Snippet {
	@Bean
	//	public static PasswordEncoder passwordEncoder() {
	//		return new BCryptPasswordEncoder();
	//	}
		
			@Bean
			SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception{
				return http.authorizeHttpRequests(registry->{
					registry.requestMatchers("product/api1.0").permitAll();
					registry.requestMatchers("/productsinfo/**").hasRole("ADMIN");
					registry.requestMatchers("/user/**").hasRole("USER");
					registry.anyRequest().authenticated();
				}).formLogin(AbstractAuthenticationFilterConfigurer::permitAll)
						.build();
			}
			
	//		@Bean
	//		InMemoryUserDetailsManager userDetailsService() {
	//			UserDetails userDetails = User.builder().
	//					username("bean").
	//					password(passwordEncoder().
	//					encode("mister")).
	//					roles("USER").
	//					build();
	//			UserDetails adminDetails = User.builder().
	//					username("bond").
	//					password(passwordEncoder().
	//					encode("james")).
	//					roles("ADMIN").
	//					build();
	//
	//			return new InMemoryUserDetailsManager(userDetails, adminDetails);
	//
	//
	//		}
}

